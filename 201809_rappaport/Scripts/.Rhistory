Gprime = Gprime,
outlierFilter = "Hampel",
filterThreshold = filterThreshold
),
negLog10Pval = -log10(pvalue),
qvalue = p.adjust(p = pvalue, method = "BH")
)
windowSize <- 0.3e6
filterThreshold <- 0.51
snp_g <- roll_freqs %>%
dplyr::select(CHROM, POS,comb_XZ_a_ct, comb_CX_a_ct)%>%
dplyr::group_by(CHROM) %>%
dplyr::mutate(nSNPs = countSNPs_cpp(POS = POS, windowSize = windowSize),
LowRef_n = median(comb_CX_a_ct,na.rm = T),
LowAlt_n = median(comb_XZ_a_ct,na.rm = T)) %>%
dplyr::mutate(
G = QTLseqr:::getG(
LowRef = LowRef_n,
HighRef = comb_CX_a_ct,
LowAlt = LowRef_n,
HighAlt = comb_XZ_a_ct),
Gprime = QTLseqr:::tricubeStat(
POS = POS,
Stat = G,
windowSize = windowSize)) %>%
dplyr::ungroup() %>%
dplyr::mutate(
pvalue = QTLseqr:::getPvals(
Gprime = Gprime,
outlierFilter = "Hampel",
filterThreshold = filterThreshold
),
negLog10Pval = -log10(pvalue),
qvalue = p.adjust(p = pvalue, method = "BH")
)
ggplot(snp_g)+
aes(x = POS/1e6)+
facet_grid(.~CHROM, scales = "free")+
geom_point(alpha = 0.3, aes(y = Gprime))+
# geom_point(alpha = 0.3, aes(y = G), color = "red")+
theme_bw()+
# ylim(c(0,1))+
labs(x = "Genomic Position (Mb)", y = "-log10p")
ggplot(snp_g)+
aes(x = POS/1e6)+
facet_grid(.~CHROM, scales = "free")+
geom_point(alpha = 0.3, aes(y = Gprime))+
# geom_point(alpha = 0.3, aes(y = G), color = "red")+
theme_bw()+
# ylim(c(0,1))+
labs(x = "Genomic Position (Mb)", y = "Gprime")
ggplot(snp_g)+
aes(x = POS/1e6)+
facet_grid(.~CHROM, scales = "free")+
geom_point(alpha = 0.3, aes(y = negLog10Pval))+
# geom_point(alpha = 0.3, aes(y = G), color = "red")+
theme_bw()+
# ylim(c(0,1))+
labs(x = "Genomic Position (Mb)", y = "-log10p")
ggsave(paste0("~/Dropbox/AndersenLab/LabFolders/Stefan/incompatibilities/CX_XZ_BSA/", "BSA_pt3bin_qtlseqr.pdf"),
height = 4,
width = 12)
plotGprimeDist(SNPset =snp_g, outlierFilter = "Hampel", filterThreshold = 0.1)
filterThreshold <- 0.1
snp_g <- roll_freqs %>%
dplyr::select(CHROM, POS,comb_XZ_a_ct, comb_CX_a_ct)%>%
dplyr::group_by(CHROM) %>%
dplyr::mutate(nSNPs = countSNPs_cpp(POS = POS, windowSize = windowSize),
LowRef_n = median(comb_CX_a_ct,na.rm = T),
LowAlt_n = median(comb_XZ_a_ct,na.rm = T)) %>%
dplyr::mutate(
G = QTLseqr:::getG(
LowRef = LowRef_n,
HighRef = comb_CX_a_ct,
LowAlt = LowRef_n,
HighAlt = comb_XZ_a_ct),
Gprime = QTLseqr:::tricubeStat(
POS = POS,
Stat = G,
windowSize = windowSize)) %>%
dplyr::ungroup() %>%
dplyr::mutate(
pvalue = QTLseqr:::getPvals(
Gprime = Gprime,
outlierFilter = "Hampel",
filterThreshold = filterThreshold
),
negLog10Pval = -log10(pvalue),
qvalue = p.adjust(p = pvalue, method = "BH")
)
ggplot(snp_g)+
aes(x = POS/1e6)+
facet_grid(.~CHROM, scales = "free")+
geom_point(alpha = 0.3, aes(y = Gprime))+
theme_bw()+
labs(x = "Genomic Position (Mb)", y = "Gprime")
ggplot(snp_g)+
aes(x = POS/1e6)+
facet_grid(.~CHROM, scales = "free")+
geom_point(alpha = 0.3, aes(y = negLog10Pval))+
theme_bw()+
labs(x = "Genomic Position (Mb)", y = "-log10p")
plotGprimeDist(SNPset =snp_g, outlierFilter = "Hampel", filterThreshold = 0.1)
6/2(2+1)
6/2*(2+1)
library(dplyr)
library(ggtree)
library(ape)
library(phangorn)
base.dir <- "~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/whole_genome/Analysis_10/Processed_Data/"
strain_pops <- data.table::fread(paste0(base.dir,"strain_pops.txt"))
ancestry.colours <- c("gold2", "plum4", "darkorange1",
"lightskyblue2", "firebrick", "burlywood3", "gray51",
"springgreen4", "lightpink2", "deepskyblue4", "lightsalmon2",
"mediumpurple4", "orange", "maroon", "yellow3", "brown4",
"yellow4", "sienna4", "chocolate", "gray19")
df <- dplyr::tbl_df(data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_geno_matrix.txt"))
df <- df[:c(7:ncol(df))]
df <- df[,c(7:ncol(df))]
df <- df[,7:ncol(df)]
df <- dplyr::tbl_df(data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_geno_matrix.txt"))
row.names(df) <- df$V1
df <- df[,7:ncol(df)]
manta_kin <- rrBLUP::A.mat(data.matrix(df))
manta_dist <- dist(manta_kin)
kin_NJ <- NJ(manta_dist)
tree<-ggtree(kin_NJ,
branch.length="rate")
tree %<+% dplyr::filter(strain_pops,V2%in%c("C","J","I"))+
scale_color_manual(values=c("darkorange1","lightpink2","deepskyblue4"))+
# theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))+
geom_tiplab(aes(color=V2))+
tree %<+% strain_pops+
geom_tiplab(aes(color=V2))+
scale_color_manual(values=ancestry.colours)+
theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))
tree %<+% dplyr::filter(strain_pops,V2%in%c("C","J","I"))+
scale_color_manual(values=c("darkorange1","lightpink2","deepskyblue4"))+
geom_tiplab(aes(color=V2))+
tree %<+% strain_pops+
geom_tiplab(aes(color=V2))+
scale_color_manual(values=ancestry.colours)+
theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))
library(dplyr)
library(ggtree)
library(ape)
library(phangorn)
tree<-ggtree(kin_NJ,
branch.length="rate")
tree %<+% dplyr::filter(strain_pops,V2%in%c("C","J","I"))+
scale_color_manual(values=c("darkorange1","lightpink2","deepskyblue4"))+
geom_tiplab(aes(color=V2))+
tree %<+% strain_pops+
geom_tiplab(aes(color=V2))+
scale_color_manual(values=ancestry.colours)+
theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))
tree %<+% dplyr::filter(strain_pops,V2%in%c("C","J","I"))+
scale_color_manual(values=c("darkorange1","lightpink2","deepskyblue4"))+
geom_tiplab(aes(color=V2))
dplyr::filter(strain_pops,V2%in%c("C","J","I"))
tree %<+% dplyr::filter(strain_pops,V2%in%c("C","J","I"))+
scale_color_manual(values=c("darkorange1","lightpink2","deepskyblue4"))+
geom_tiplab(aes(color=V2))
View(kin_NJ)
tree
dplyr::filter(strain_pops,V2%in%c("C","J","I"))
tree<-ggtree(kin_NJ,
branch.length="rate") +
geom_tiplab(color='blue')
tree
df <- dplyr::tbl_df(data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_geno_matrix.txt"))
row.names(df) <- df$V1
df <- data.frame(df[,7:ncol(df)])
row.names(df)
df <- dplyr::tbl_df(data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_geno_matrix.txt"))
df$V1
strains <- df$V1
df <- data.frame(df[,7:ncol(df)])
row.names(df) <- strains
manta_kin <- rrBLUP::A.mat(data.matrix(df))
manta_dist <- dist(manta_kin)
kin_NJ <- NJ(manta_dist)
tree<-ggtree(kin_NJ,
branch.length="rate") +
geom_tiplab(aes(color=V2))+
ggplot2::xlim(0, 4)
tree<-ggtree(kin_NJ,
branch.length="rate")
tree %<+% strain_pops+
geom_tiplab(aes(color=V2))+
scale_color_manual(values=ancestry.colours)+
theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))
ggsave("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_phylogeny.pdf",
height = 35,
width = 12)
tree %<+% strain_pops+
geom_tiplab(aes(color=V2))+
scale_color_manual(values=ancestry.colours)+
theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))+
xlim(c(0,2))
ggsave("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_phylogeny.pdf",
height = 35,
width = 12)
tree %<+% strain_pops+
geom_tiplab(aes(color=V2))+
scale_color_manual(values=ancestry.colours)+
theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))+
xlim(c(0,4))
tree %<+% strain_pops+
geom_tiplab(aes(color=V2))+
scale_color_manual(values=ancestry.colours)+
theme(plot.margin=unit(c(1.5,1.5,1.5,1.5),"cm"))+
xlim(c(0,5))
ggsave("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_phylogeny.pdf",
height = 35,
width = 12)
ggsave("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SV/manta_phylogeny.pdf",
height = 38,
width = 12)
swept <- data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SFS/dan_method/functionalize/sweep_summary.tsv")
swept <- data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SFS/dan_method/functionalize/sweep_summary.tsv")
View(swept)
View(swept)
zero_sweep <- swept %>%
dplyr::filter(swept_chroms == 0)
library(tidyverse)
swept <- data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/admixture/SFS/dan_method/functionalize/sweep_summary.tsv")
zero_sweep <- swept %>%
dplyr::filter(swept_chroms == 0)
View(zero_sweep)
zero_one_sweep <- swept %>%
dplyr::filter(swept_chroms < 2)
zero_two_sweep <- swept %>%
dplyr::filter(swept_chroms < 3)
zero_sweep <- swept %>%
dplyr::filter(swept_chroms == 0)%>%
dplyr::pull(isotype)
zero_sweep <- paste(zero_sweep,collapse = ",")
zero_sweep
zero_one_sweep <- swept %>%
dplyr::filter(swept_chroms < 2)%>%
dplyr::pull(isotype)
zero_one_sweep <- paste(zero_one_sweep,collapse = ",")
zero_two_sweep <- swept %>%
dplyr::filter(swept_chroms < 3)%>%
dplyr::pull(isotype)
zero_two_sweep <- paste(zero_two_sweep,collapse = ",")
zero_one_sweep
zero_two_sweep
# set to location of files
main.dir <- "~/Dropbox/AndersenLab/LabFolders/Stefan/Manuscripts/Arsenic/"
data.dir <- paste0(main.dir,"Data/")
plot.dir <- paste0(main.dir,"Plots/")
script.dir <- paste0(main.dir,"Scripts/")
# load functions used in this script
source(paste0(script.dir,"processing_functions.R"))
trait_of_interest <- "median.TOF"
comparison_trait <- "q90.TOF"
condition_of_interest <- "arsenictrioxide"
control_of_interest <- "1percwater"
arsenic.theme <-  theme(axis.text.x = ggplot2::element_text(size = 14),
axis.text.y = ggplot2::element_text(size = 14),
axis.title.x = ggplot2::element_text(size = 18, face = "bold", color = "black", vjust = -0.3),
axis.title.y = ggplot2::element_text(size = 18, face = "bold", color = "black", vjust = -0.3),
strip.text.x = element_text(size = 14, face = "bold"))
metabolites <- data.table::fread("~/Dropbox/AndersenLab/LabFolders/Stefan/Manuscripts/Arsenic/Data/Table12_Metabolite_measurements.tsv")%>%
tidyr::separate(Sample, into = c("strain", "replicate", "concentration"), sep = "-")%>%
dplyr::select(-TIC)%>%
dplyr::filter(!(strain == "581" & replicate == "C" & concentration == "Mock"))%>%
dplyr::mutate(rC15 = C15iso/C15n,
rC17 = C17iso/C17n)%>%
tidyr::gather(compound, value, -strain, -replicate, -concentration)
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("rC15"), concentration != "200")
met_ratio <- rC15%>%
ggplot()+
aes(x = factor(strain, levels = c("N2","CB","581","590"), labels = c("N2", "CB4856","N2\nDBT-1(S78)", "CB4856\nDBT-1(C78)")), y = value, fill = concentration)+
geom_point(shape =21, size = 3)+
scale_fill_manual(values = c("hotpink3","cadetblue3"))+
theme_classic()+
arsenic.theme+ theme(legend.position = "None",
axis.title.x = ggplot2::element_text(size = 0),
axis.title.y = ggplot2::element_text(size = 16))+
labs(y = "C15iso/C15straight")
met_ratio
for( s in unique(metabolites$strain)){
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("C15iso"), concentration != "200") %>%
dplyr::filter(strain==s)
print(s)
fit <- aov(value ~ concentration , data=rC15)
print(TukeyHSD(fit))
}
for( s in unique(metabolites$strain)){
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("C17iso"), concentration != "200") %>%
dplyr::filter(strain==s)
print(s)
fit <- aov(value ~ concentration , data=rC15)
print(TukeyHSD(fit))
}
#c15iso
for( s in unique(metabolites$strain)){
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("C15iso"), concentration != "200") %>%
dplyr::filter(strain==s)
print(s)
fit <- aov(value ~ concentration , data=rC15)
print(TukeyHSD(fit))
}
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("C15iso"), concentration != "200")
rC15%>%
ggplot()+
aes(x = factor(strain, levels = c("N2","CB","581","590"), labels = c("N2", "CB4856","N2\nDBT-1(S78)", "CB4856\nDBT-1(C78)")), y = value, fill = concentration)+
geom_point(shape =21, size = 3)+
scale_fill_manual(values = c("hotpink3","cadetblue3"))+
theme_classic()+
arsenic.theme+ theme(legend.position = "None",
axis.title.x = ggplot2::element_text(size = 0),
axis.title.y = ggplot2::element_text(size = 16))+
labs(y = "C15iso/C15straight")
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("rC15"), concentration != "200")
rC15%>%
ggplot()+
aes(x = factor(strain, levels = c("N2","CB","581","590"), labels = c("N2", "CB4856","N2\nDBT-1(S78)", "CB4856\nDBT-1(C78)")), y = value, fill = concentration)+
geom_point(shape =21, size = 3)+
scale_fill_manual(values = c("hotpink3","cadetblue3"))+
theme_classic()+
arsenic.theme+ theme(legend.position = "None",
axis.title.x = ggplot2::element_text(size = 0),
axis.title.y = ggplot2::element_text(size = 16))+
labs(y = "C15iso/C15straight")
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("rC17"), concentration != "200")
rC15%>%
ggplot()+
aes(x = factor(strain, levels = c("N2","CB","581","590"), labels = c("N2", "CB4856","N2\nDBT-1(S78)", "CB4856\nDBT-1(C78)")), y = value, fill = concentration)+
geom_point(shape =21, size = 3)+
scale_fill_manual(values = c("hotpink3","cadetblue3"))+
theme_classic()+
arsenic.theme+ theme(legend.position = "None",
axis.title.x = ggplot2::element_text(size = 0),
axis.title.y = ggplot2::element_text(size = 16))+
labs(y = "C15iso/C15straight")
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("rC15"), concentration != "200")
rC15%>%
ggplot()+
aes(x = factor(strain, levels = c("N2","CB","581","590"), labels = c("N2", "CB4856","N2\nDBT-1(S78)", "CB4856\nDBT-1(C78)")), y = value, fill = concentration)+
geom_point(shape =21, size = 3)+
scale_fill_manual(values = c("hotpink3","cadetblue3"))+
theme_classic()+
arsenic.theme+ theme(legend.position = "None",
axis.title.x = ggplot2::element_text(size = 0),
axis.title.y = ggplot2::element_text(size = 16))+
labs(y = "C15iso/C15straight")
metabolites%>%
dplyr::filter(compound %in% c("rC15"), concentration != "200")
rC15 <- metabolites%>%
dplyr::filter(compound %in% c("rC15"), concentration != "200")
rC15%>%
ggplot()+
aes(x = factor(strain, levels = c("N2","CB","581","590"), labels = c("N2", "CB4856","N2\nDBT-1(S78)", "CB4856\nDBT-1(C78)")), y = value, fill = concentration)+
geom_point(shape =21, size = 3)+
scale_fill_manual(values = c("hotpink3","cadetblue3"))+
theme_classic()+
arsenic.theme+ theme(legend.position = "None",
axis.title.x = ggplot2::element_text(size = 0),
axis.title.y = ggplot2::element_text(size = 16))+
labs(y = "C15iso/C15straight")
View(metabolites)
metabolites%>%
dplyr::filter(compound %in% c("rC15"), concentration != "200") %>%
dplyr::group_by(strain, concentration)%>%
dplyr::summarise(m_met = mean(value))
0.367 - 0.195
.195/.367
.349/.403
.349/.503
1-.53
1-69
1-.69
# # # LOAD AND PROCESS INDELS
ben1_indels <- data.table::fread(paste0(data.dir, "ben1_Indels/20171021_ben1_indels.csv"))%>%
na.omit()
main.dir <- "~/Dropbox/AndersenLab/LabFolders/Stefan/labmeeting/201809_rappaport/"
setwd(main.dir)
data.dir <- paste0("~/Dropbox/HTA/Results/2017_anthelmintic_gwa/analysis/ben1_paper/Raw_data/")
plot.dir <- paste0(main.dir,"Plots/")
script.dir <- paste0(main.dir,"Scripts/")
final.dir <- paste0(main.dir,"Data/ben1_data/Final_Tables/")
source(paste0(script.dir,"ben1_processing_functions.R"))
source(paste0(script.dir,"N2_CB.R"))
trait_of_interest <- "q90.TOF"
condition_of_interest <- "albendazole"
control_of_interest <- "DMSO"
library(ggbeeswarm)
# # # LOAD AND PROCESS INDELS
ben1_indels <- data.table::fread(paste0(data.dir, "ben1_Indels/20171021_ben1_indels.csv"))%>%
na.omit()
pr_indels <- ben1_indels %>%
tidyr::unite(marker, Type, Start, End, sep ="_",remove=F)%>%
dplyr::filter(comments == "frame shift" | grepl("Exon", location) | Type == "trans")%>%
dplyr::filter(!grepl("Intron",location,ignore.case = T))%>%
dplyr::mutate(GT = ifelse(marker == "_NA_NA", "REF", "ALT"))%>%
dplyr::select(marker, strain = Strain, GT,start = Start,end =End)%>%
dplyr::distinct(strain, marker, GT,.keep_all=T)
# # # LOAD AND PROCESS SNPS
ben1_snps <- cegwas::snpeff("ben-1",severity = "ALL",elements = "ALL")
ben1_snps_pr <- ben1_snps%>%
dplyr::select(POS, strain, GT, nt_change, effect, impact)%>%
tidyr::unite(marker, effect,impact,nt_change,POS,sep="_",remove=F)%>%
dplyr::select(marker, strain, GT,start = POS)%>%
dplyr::mutate(end = start)%>%
dplyr::filter(!grepl("MODIF|syn",marker))
# # # COMBINE SNPS AND INDELS
ben1_variants <- dplyr::bind_rows(ben1_snps_pr,pr_indels)%>%
dplyr::filter(GT=="ALT")
gwa_mappings <-  data.table::fread(file = paste0(final.dir,"TS5_GWA_processed_marker_mapping.tsv"))%>%
na.omit()%>%
dplyr::mutate(snpGT = ifelse(allele==-1,"REF", "ALT"))%>%
dplyr::select(snpMarker = marker, strain, trait, value, snpGT)%>%
dplyr::filter(trait == "q90.tof")%>%
dplyr::left_join(.,ben1_variants, by = "strain")
gwa_mappings$snpMarker <- gsub("_",":", gwa_mappings$snpMarker)
colors <- c("Deletion" = "#E69F00","Insertion" = "#56B4E9","Inversion" = "#D55E00","Stop Gained" = "#F0E442",
"Transposon\nInsertion" = "#0072B2","Missense" = "#009E73","Splice Donor" = "#CC79A7","None" = "#999999")
gwa_mappings <- gwa_mappings%>%
dplyr::mutate(length = end-start)%>%
dplyr::mutate(ben1_prediction = ifelse(is.na(GT), "A",
ifelse(grepl("del", marker),"Deletion",
ifelse(grepl("ins", marker,ignore.case = T),"Insertion",
ifelse(grepl("inv", marker),"Inversion",
ifelse(grepl("stop", marker),"Stop Gained",
ifelse(grepl("trans", marker),"Transposon\nInsertion",
ifelse(grepl("missense", marker),"Missense","Splice Donor"))))))))
gwa_mappings <- gwa_mappings %>%
tidyr::separate(snpMarker, into = c("CHROM","POS"),sep = ":",remove=F,convert=T)%>%
dplyr::arrange(CHROM,POS)%>%
dplyr::mutate(marker2 = factor(snpMarker, levels = unique(snpMarker), labels = unique(snpMarker)))%>%
dplyr::distinct(marker2, value, .keep_all=T) %>%
dplyr::arrange(value)%>%
dplyr::mutate(strain2 = factor(strain, levels = unique(strain), labels = unique(strain), ordered = T))%>%
dplyr::mutate(norm_pheno_temp = ifelse(value == min(value), 0, 1))%>%
dplyr::mutate(delta_pheno = ifelse(norm_pheno_temp == 0, 0, abs(dplyr::lag(value) - value)))%>%
dplyr::mutate(norm_pheno = cumsum(delta_pheno)) %>%
dplyr::mutate(final_pheno = norm_pheno/max(norm_pheno))
ggplot(gwa_mappings)+
aes(x = snpGT, y = final_pheno)+
geom_boxplot(outlier.colour = NA, fill = background_color)+
facet_grid(.~marker2)+
geom_beeswarm(shape = 21, color= "black", alpha = 0.8, fill = "#999999", data = dplyr::filter(gwa_mappings, is.na(marker)),cex=1.2)+
geom_beeswarm(aes(fill=ben1_prediction), data = na.omit(gwa_mappings), shape = 21, color= "black", size = 2,cex=3)+
scale_fill_manual(values=colors,name = expression(paste("Variation at ", italic("ben-1"))))+
theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_text(size = 16),
axis.text.y = ggplot2::element_text(size = 16),
axis.title.x = ggplot2::element_text(size = 16, face = "bold", color = "black", vjust = -0.3),
axis.title.y = ggplot2::element_text(size = 16, face = "bold", color = "black"),
strip.text.x = ggplot2::element_text(size = 12, face = "bold", color = "black"),
strip.text.y = ggplot2::element_text(size = 12, face = "bold", color = "black"),
plot.title = ggplot2::element_text(size = 24, face = "bold", vjust = 1),
panel.background = ggplot2::element_rect(color = "black",size = 1.2))+
base_theme+
theme(legend.position = "none")+
labs(x = "SNV Genotype at QTL", y = "Relative BZ resistance")
ggplot(gwa_mappings)+
aes(x = snpGT, y = final_pheno)+
geom_boxplot(outlier.colour = NA, fill = background_color)+
facet_grid(.~marker2)+
geom_beeswarm(shape = 21, color= "black", alpha = 0.8, fill = "#999999", data = dplyr::filter(gwa_mappings, is.na(marker)),cex=1.2)+
geom_beeswarm(aes(fill=ben1_prediction), data = na.omit(gwa_mappings), shape = 21, color= "black", size = 4,cex=3)+
scale_fill_manual(values=colors,name = expression(paste("Variation at ", italic("ben-1"))))+
theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_text(size = 16),
axis.text.y = ggplot2::element_text(size = 16),
axis.title.x = ggplot2::element_text(size = 16, face = "bold", color = "black", vjust = -0.3),
axis.title.y = ggplot2::element_text(size = 16, face = "bold", color = "black"),
strip.text.x = ggplot2::element_text(size = 12, face = "bold", color = "black"),
strip.text.y = ggplot2::element_text(size = 12, face = "bold", color = "black"),
plot.title = ggplot2::element_text(size = 24, face = "bold", vjust = 1),
panel.background = ggplot2::element_rect(color = "black",size = 1.2))+
base_theme+
theme(legend.position = "none")+
labs(x = "SNV Genotype at QTL", y = "Relative BZ resistance")
ggsave(paste0(plot.dir,"marker_qtl_bxplot_colored_by_ben1.png"),
height = 4,
width = 12)
ggplot(gwa_mappings)+
aes(x = snpGT, y = final_pheno)+
geom_boxplot(outlier.colour = NA, fill = background_color)+
facet_grid(.~marker2)+
geom_beeswarm(shape = 21, color= "black", alpha = 0.8, fill = "#999999", data = dplyr::filter(gwa_mappings, is.na(marker)),cex=1.2)+
geom_beeswarm(aes(fill=ben1_prediction), data = na.omit(gwa_mappings), shape = 21, color= "black", size = 3,cex=3)+
scale_fill_manual(values=colors,name = expression(paste("Variation at ", italic("ben-1"))))+
theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_text(size = 16),
axis.text.y = ggplot2::element_text(size = 16),
axis.title.x = ggplot2::element_text(size = 16, face = "bold", color = "black", vjust = -0.3),
axis.title.y = ggplot2::element_text(size = 16, face = "bold", color = "black"),
strip.text.x = ggplot2::element_text(size = 12, face = "bold", color = "black"),
strip.text.y = ggplot2::element_text(size = 12, face = "bold", color = "black"),
plot.title = ggplot2::element_text(size = 24, face = "bold", vjust = 1),
panel.background = ggplot2::element_rect(color = "black",size = 1.2))+
base_theme+
theme(legend.position = "none")+
labs(x = "SNV Genotype at QTL", y = "Relative BZ resistance")
ggsave(paste0(plot.dir,"marker_qtl_bxplot_colored_by_ben1.png"),
height = 4,
width = 12)
